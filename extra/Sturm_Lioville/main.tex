\chapter{Sturm-Liouville Differential Equation}

\section{Motivation}

Many of the problems we have studied follow from general properties of the Sturm-Lioville (SL) problem.
In these problems, a system is governed by the differential equation of the form 
\begin{eqnarray}
    \label{eq:SL-DE}
    \dv{x}\Bigg[ p(x) \dv{x} \Bigg] \phi(x) + q(x) \phi(x) =  -\lambda r(x) \phi(x)
\end{eqnarray}
for $x \in [a,b]$, where $a,b \in \R$ and some real functions $p,q,r$, where $p(x),r(x) > 0$ for $x \in (a,b)$\footnote{Note that the endpoints are excluded here!}.
This is in essence an eigenvalue problem, where we would like to determine the eigenvalues $\lambda$ and corresponding eigenfunctions $\phi(x)$ which satisfy \eref{SL-DE} for a given set of $p,q,r$.

For example, the Schr\"{o}dinger equation, Bessel's equation, and Legendre's equation all fall under this category.
Clearly, the particular properties that determines a system's unique behavior depend on $p,q,r$, but the general methods by which we uncover these all follow the same generic trend which follow from general behaviors of systems with a Sturm-Lioville description.


\section{Boundary Conditions}

Since the \eref{SL-DE} is a second-order differential equation, we have two linearly independent solutions $y_{1,2}$ for a given set of functions $p,q,r$, and a general solution $y = \alpha_1 y_1 + \alpha_2 y_2$, where $\alpha_{1,2}$ are constants.
These constants are determined by boundary conditions at $x=a,b$ by specifying (1) $y(a)$ and $y(b)$ [Dirichlet BCs], (2) $y'(a)$ and $y'(b)$ [Neumann BCs], or (3) $c_a y(a) + d_{a} y'(a)$ and $c_{b} y(b) + d_{b}y'(b)$ [Robin BCs].
For the most part, we focus on Dirichlet BCs (e.g. specifying the value of the wave function) and Neumann (e.g. specifying the surface charge density).
It is rare in the textbook problems that a linear combination of the function and its derivative are specified since these linear combinations are not usually related to a physical quantity.
For the development of general properties, though, we will reference these kind of BCs, but Dirichlet and Neumann BCs are recovered by setting $d_{a,b} = 0$ and $c_{a,b} = 0$, respectively.

Finally, in some cases, a fourth distinct set of BCs can be specified, which are called periodic BCs.
As the name suggests we either have $y(a) = y(b)$ or $y'(a) = y'(b)$.

\section{Definitions}

Let us define a couple of terms that will be used to identify the type of equation we consider.

\begin{enumerate}
    \item A \textit{regular} SL system is one such that homogeneous mixed BCs are given: $c_{a}y(a) + d_{a}y'(a) = 0$ and $c_{b}y(b) + d_{b}y'(b) = 0$
    \item A \textit{periodic} SL system is one such that periodic BCs are specified and $p(a) = p(b)$
    \item A \textit{singular} SL system is one where any of the following occur:
    \begin{itemize}
        \item $p(a) = 0$, no BC at $a$ is given, and the BC at $b$ is homogeneous mixed (Note: solutions must be bounded at $x=a$)\footnote{A function $f$ is bounded at $x$ if $|f(x)| < M$ for some $M$.}
        \item $p(b) = 0$, no BC at $b$ is given, and the BC at $a$ is homogeneous mixed (Note: solutions must be bounded at $x = a$)
        \item $p(a) = p(b) = 0$ and no BCs are given (solutions must be bounded at both $x = a,b$.)
        \item $a \rightarrow -\infty$ and $b \rightarrow \infty$ such that the equation is defined on $\R$ (Note: solutions must be square-integrable on $\R$)\footnote{A function $f$ is square-integrable if $\int_{-\infty}^{\infty} |f(x)|^2 < \infty$ (i.e. the integral is convergent and bounded).}
    \end{itemize}
\end{enumerate}


\section{Properties of the Sturm-Liouville System}

\subsection{Sturm-Lioville Operator}

Let $\mathcal{L}^2([a,b],r(x),\dd{x})$ be the Hilbert space of square integrable functions on the interval $[a,b]$ with inner product
\begin{eqnarray}
    (f,g) = \int_{a}^{b} r(x) f^{*}(x) g(x) \dd{x}
.\end{eqnarray}
It is for this reason that $r(x)$ is sometimes denoted a \textit{weight} function.

Denote the linear differential operator
\begin{eqnarray}
    \label{eq:SL-lin-op}
    \hat{L} = -\frac{1}{r(x)} \Bigg[ \dv{x} p(x) \dv{x} + q(x) \Bigg]
,\end{eqnarray}
and let $\mathcal{H} \subset \mathcal{L}^2$ be the subspace of functions which are square integrable and satisfy a given set of BCs.
The SL problem can then be stated as 
\begin{eqnarray}
    \hat{L} \phi(x) = \lambda \phi(x)
,\end{eqnarray}
and because of this relation we call $L$ the SL operator.
Effectively, we have explicitly rewritten \eref{SL-DE} as an eigenvalue equation.
We now study generally some properties of the SL operator and its spectrum and space of eigenfunctions.

\subsection{Facts about solutions and eigenvalues of the Sturm-Lioville problem}
\textbf{Theorem 1}: \textit{The SL operator is self-adjoint}. Recall that the adjoint $A^{\dagger}$ of an operator $A$ is defined by the equality $(A^{\dagger}f, g) = (f,Ag)$, and a self-adjoint operator is one such that $A^{\dagger} = A$.
The proof is as follows for the SL operator.
Consider the inner product
\begin{align}
    (f,Lg) &= \int_{a}^{b} r f^{*} \hat{L} g \dd{x} = \int_{a}^{b} f^{*} \Bigg[ - \dv{x} \Big( p \dv{x} \Big) + q \Bigg] g \dd{x} \nonumber \\
    &= -\int_{a}^{b} f^{*} \dv{x} \Big( p \dv{x} \Big) g \dd{x} + \int_{a}^{b} [ q f ]^{*} g \dd{x} \nonumber \\
    &= -\Big[ f^{*} p g' \Big]_{a}^{b} + \int_{a}^{b} p \dv{f^{*}}{x} \dv{g}{x} \dd{x} + \int_{a}^{b} [ q f ]^{*} g \dd{x} \nonumber \\
    &= \Bigg[ p \Bigg( \dv{f^{*}}{x} g - f^{*} \dv{g}{x} \Bigg) \Bigg]_{a}^{b} + \int_{a}^{b} \Bigg\{ \Bigg[ -\dv{x} p \dv{x} + q \Bigg] f \Bigg\}^{*} g \dd{x} \nonumber \\
    &= \int_{a}^{b} ( \hat{L} f )^{*} g \dd{x} = ( \hat{L} f,g )
.\end{align}
Note that the boundary term from the integrations by parts is zero for certain homogeneous BCs we discussed above.
This is straightforward to see for homogeneous Dirichlet BCs ($f(a) = f(b) = g(a) = g(b) = 0$) and Neumann BCs ($f'(a) = f'(b) = g'(a) = g'(b) = 0$).

\textbf{Theorem 2}: \textit{The eigenvalues of $\hat{L}$ are real}.
Suppose $\phi_{\lambda} \not\equiv 0$ is the function with corresponding eigenvalue $\lambda$.
That is $\hat{L} \phi_{\lambda} = \lambda \phi_{\lambda}$.
Since $\hat{L}$ is self-adjoint, we can write
\begin{align}
    (\hat{L}\phi_{\lambda},\phi_{\lambda}) &= (\phi_{\lambda},\hat{L}\phi_{\lambda}) \nonumber \\
    (\lambda \phi_{\lambda},\phi_{\lambda}) &= (\phi_{\lambda},\lambda \phi_{\lambda}) \nonumber \\
    \lambda^{*} (\phi_{\lambda},\phi_{\lambda}) &= \lambda (\phi_{\lambda},\phi_{\lambda}) \nonumber \\
    \lambda^{*} &= \lambda
\end{align}

\textbf{Theorem 3}: \textit{If $\phi_{\lambda}$ and $\phi_{\mu}$ correspond to distinct eigenvalues $\lambda$ and $\mu$, then $\phi_{\lambda}$ and $\phi_{\mu}$ are orthogonal (i.e. $(\phi_{\lambda},\phi_{\mu}) = 0$)}.
The proof of this fact is straightforward.
The eigenfunctions satisfy $\hat{L} \phi_{\lambda} = \lambda \phi_{\lambda}$ and $\hat{L} \phi_{\mu} = \mu \phi_{\mu}$.
It follows then that
\begin{align}
    (\hat{L}\phi_{\lambda},\phi_{\mu}) &= (\phi_{\lambda},\hat{L}\phi_{\mu}) \nonumber \\
    \lambda(\phi_{\lambda},\phi_{\mu}) &= \mu(\phi_{\lambda},\phi_{\mu})
.\end{align}
Rewriting we have
\begin{eqnarray}
    [\lambda - \mu](\phi_{\lambda},\phi_{\mu}) = 0 \Rightarrow (\phi_{\lambda},\phi_{\mu}) = 0
\end{eqnarray}
since by assumption $\lambda \ne \mu$.

\textbf{Theorem 4}: \textit{The spectrum of $\hat{L}$ is non-degenerate}.
That is to say that if $\phi_1$ and $\phi_2$ correspond to the same eigenvalue, then $\phi_2 = c \phi_2$, or $\phi_1$ and $\phi_2$ are linearly dependent.
We prove this by contradiction.
Suppose that there exists $\phi_1 \ne \phi_2$ such that $\hat{L} \phi_{1,2} = \lambda \phi_{1,2}$.
We then have
\begin{align}
    \phi_2 \hat{L} \phi_1 - \phi_1 \hat{L} \phi_2 &=  -\frac{1}{r(x)} \Big[ \phi_2 \dv{x} \Big( p \phi_1 \Big) - \phi_1' \dv{x} \Big( p \phi_2' \Big) \Big] = 0 \nonumber \\
                                                  &= -\frac{1}{r(x)} \dv{x} \underbrace{ p(x) \Big[ \phi_1' \phi_2 - \phi_1 \phi_2' \Big] }_{W[\phi_1,\phi_2]} = 0
.\end{align}
We then have 
\begin{eqnarray}
    p(x) W[\phi_1(x),\phi_2(x)] = c
.\end{eqnarray}
Notice that for homogeneous BCs,
\begin{eqnarray}
    W[\phi_1(x),\phi_2(x)] = \dv{\phi_1}{x} \phi_2 - \phi_1 \dv{\phi_2}{x} = 0
.\end{eqnarray}
This is simple to see for pure Dirichlet and Neumann BCs since either the function or the derivative is zero at the boundaries.
Thus, we have a separable $1^{\rm st}$ order equation with solution
\begin{eqnarray}
    \phi_1(x) = c\phi_2(x)
.\end{eqnarray}

\textbf{Theorem 5}: \textit{The set of eigenfunctions is a basis for $\mathcal{H}$}.
Equivalently, the set of eigenfunctions $\{ \phi_{\lambda} \} $.
Let us assume for now that $\hat{L}$ has a countable spectrum, allowing us to label the eigenfunctions by natural numbers such that eigenvalue $\lambda_{n}$ corresponds to eigenfunction $\phi_{n}$.
A rigorous statement of completeness is this: if $\psi(x)$ is any function in $\mathcal{H}$,
\begin{eqnarray}
    \lim_{n \rightarrow N} || \psi(x) - \sum_{k=1}^{n} c_{k} \phi_{k} ||
,\end{eqnarray}
where $N$ is the number of discrete eigenvalues in the spectrum of $\hat{L}$ (possibly infinite).
Note that the coefficients $c_{k} = (\phi_{k},\psi)$ and the norm $|| \cdot ||$ is defined as $|| \psi || = \sqrt{(\psi,\psi)}$.
Another way of stating completeness is that
\begin{eqnarray}
    \sum_{n} \phi_{n}^{*}(x') \phi_{n}(x) = \delta(x - x')
.\end{eqnarray}
This is equivalent since any function $\psi \in \mathcal{H}$ can be expressed as
\begin{eqnarray}
\psi(x) = \int_{a}^{b} \dd{x'} \psi(x') \delta(x - x') = \sum_{n} \phi_{n}(x) \underbrace{ \int_{a}^{b} \dd{x'} \phi_{n}^{*}(x') \psi(x') }_{c_{n}}
.\end{eqnarray}

Note that there was no ``proof'' here.
We really just posited that the eigenfunctions of $\hat{L}$ forms a complete basis.
The proof is quite involved and requires a more formal and advanced treatment than is within the scope of this discussion.
We will assume that the mathematicians who have proven this result are quite competent\footnote{This argument is a bit flippant and depends on the assumption that the probability of a mistake being missed in the proof going to zero as the number of people who validated it goes to infinity (law of large numbers).} and will simply take it as fact.
It is essential that this theorem is true, though, since many of our problems hinge on the completeness of the eigenfunctions and our ability to expand a solution of an arbitrary SL problem in this basis.







